<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no" />
    <title>Intro to SceneView - Create a 3D map</title>
    <!-- Calcite Bootstrap -->
    <link rel="stylesheet" href="https://esri.github.io/calcite-maps/dist/css/calcite-maps-bootstrap.min-v0.8.css" />
    <!-- Material Design for Bootstrap fonts and icons -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Material+Icons">
    <!-- Material Design for Bootstrap CSS -->
    <link rel="stylesheet" href="https://unpkg.com/bootstrap-material-design@4.1.1/dist/css/bootstrap-material-design.min.css" integrity="sha384-wXznGJNEXNG1NFsbm0ugrLFMQPWswR3lds2VeinahP8N0zJw9VWSopbjv2x7WCvX" crossorigin="anonymous">


    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/popper.js@1.12.6/dist/umd/popper.js" integrity="sha384-fA23ZRQ3G/J53mElWqVJEGJzU0sTs+SvzG8fXVWP+kJQ1lwFAOkcUOysnlKJC33U" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/bootstrap-material-design@4.1.1/dist/js/bootstrap-material-design.js" integrity="sha384-CauSuKpEqAFajSpkdjv3z9t8E7RlpJ1UP0lKM/+NdtSarroVKu069AlsRPKkFBz9" crossorigin="anonymous"></script>
    <script>
        $(document).ready(function() {
            $('body').bootstrapMaterialDesign();
        });
    </script>

    <style>
        html,
        body,
        #viewDiv {
            padding: 0;
            margin: 0;
            height: 100%;
            width: 100%;
        }
        
        .navbar-light .navbar-toggler {
            color: rgba(0, 0, 0, .5);
            border-color: rgb(49, 48, 48);
            position: absolute;
            left: 10px;
        }
        
        .navbar {
            background-color: rgba(0, 255, 255, 0);
            opacity: 0.5;
            position: relative;
            min-height: 50px;
            margin-bottom: 1px;
            border: 1px solid transparent;
        }
    </style>
    <link rel="stylesheet" href="https://js.arcgis.com/4.11/esri/themes/light/main.css" />
    <script src="https://js.arcgis.com/4.11/"></script>
</head>

<body>
    <div class="bmd-layout-container bmd-drawer-f-t bmd-drawer-overlay">

        <header class="bmd-layout-header">
            <div class="navbar navbar-light bg-faded">
                <button class="navbar-toggler" type="button" data-toggle="drawer" data-target="#dw-p3">
                      <span class="sr-only">Toggle drawer</span>
                      <i class="material-icons">menu</i>
                    </button>
                <ul class="nav navbar-nav">
                    <li class="nav-item">Title</li>
                </ul>
            </div>
        </header>

        <div id="dw-p3" class="bmd-layout-drawer bg-faded">
            <header>
                <a class="navbar-brand">Title</a>
            </header>
            <ul class="list-group">
                <a class="list-group-item">Link 1</a>
                <a class="list-group-item">Link 2</a>
                <a class="list-group-item">Link 3</a>
            </ul>
        </div>

        <div id="viewDiv"></div>
        <div id="sketchPanel" class="esri-widget">
      <button id="extrudedPolygon" data-type="polygon" class="esri-button">
        Draw a building
      </button>
      <button id="point" data-type="point" class="esri-button">
        Draw a point of interest
      </button>
      <button id="line" data-type="polyline" class="esri-button">
        Draw a route
      </button>
    </div>
    </div>


    <script>
        require(["esri/Map",
                "esri/views/SceneView",
                "esri/Basemap",
                "esri/layers/ElevationLayer",
                "esri/layers/GraphicsLayer",
                "esri/widgets/Sketch/SketchViewModel",
                "esri/symbols/WebStyleSymbol"
            ],
            function(Map, SceneView, Basemap, ElevationLayer, GraphicsLayer, SketchViewModel, WebStyleSymbol) {
                var basemap = new Basemap({
                    portalItem: {
                        id: "a1f189886ef54c5b8e03e37695e8925d" // gr√•tone
                    }
                });

                var elevLyr = new ElevationLayer({
                    portalItem: {
                        id: "4526a4d94b844467a3ce130da8ca172d"
                    }
                });

                var map = new Map({
                    basemap: basemap,
                    ground: "world-elevation",
                    ground: {
                        surfaceColor: "#FCFCFC"
                    }
                });
                map.ground.layers.add(elevLyr);

                var view = new SceneView({
                    container: "viewDiv",
                    map: map,
                    alphaCompositingEnabled: true,
                    environment: {
                        background: {
                            type: "color", // autocasts as new ColorBackground()
                            color: "#FCFCFC"
                        },
                        // disable stars
                        starsEnabled: false,
                        //disable atmosphere
                        atmosphereEnabled: true
                    },
                    center: {
                        x: 256924.68078,
                        y: 6605196.9098,
                        z: 5000,
                        spatialReference: 25833
                    }

                });
const blue = [82, 82, 122, 0.9];
        const white = [255, 255, 255, 0.8];

        // polygon symbol used for sketching the extruded building footprints
        const extrudedPolygon = {
          type: "polygon-3d",
          symbolLayers: [
            {
              type: "extrude",
              size: 10, // extrude by 10 meters
              material: {
                color: white
              },
              edges: {
                type: "solid",
                size: "3px",
                color: blue
              }
            }
          ]
        };

        // polyline symbol used for sketching routes
        const route = {
          type: "line-3d",
          symbolLayers: [
            {
              type: "line",
              size: "3px",
              material: {
                color: blue
              }
            },
            {
              type: "line",
              size: "10px",
              material: {
                color: white
              }
            }
          ]
        };

        // point symbol used for sketching points of interest
        const point = {
          type: "point-3d",
          symbolLayers: [
            {
              type: "icon",
              size: "20px",
              resource: { primitive: "kite" },
              outline: {
                color: blue,
                size: "3px"
              },
              material: {
                color: white
              }
            }
          ]
        };

        // define the SketchViewModel and pass in the symbols for each geometry type
        const sketchVM = new SketchViewModel({
          layer: gLayer,
          view: view,
          pointSymbol: point,
          polygonSymbol: extrudedPolygon,
          polylineSymbol: route
        });

        // add an event listener for the Delete key to delete
        // the graphics that are currently being updated
        view.on("key-up", function(evt) {
          if (evt.key === "Delete") {
            gLayer.removeMany(sketchVM.updateGraphics);
            sketchVM.reset();
          }
        });

        // after drawing the geometry, enter the update mode to update the geometry
        // and the deactivate the buttons
        sketchVM.on("create", function(event) {
          if (event.state === "complete") {
            sketchVM.update(event.graphic);
            deactivateButtons();
          }
        });

        const drawButtons = Array.prototype.slice.call(
          document.getElementsByClassName("esri-button")
        );

        // set event listeners to activate sketching graphics
        drawButtons.forEach(function(btn) {
          btn.addEventListener("click", function(event) {
            deactivateButtons();
            event.target.classList.add("esri-button--secondary");
            // to activate sketching the create method is called passing in the geometry type
            // from the data-type attribute of the html element
            sketchVM.create(event.target.getAttribute("data-type"));
          });
        });

        function deactivateButtons() {
          drawButtons.forEach(function(element) {
            element.classList.remove("esri-button--secondary");
          });
        }

        view.ui.add("sketchPanel", "top-right");
      });

            });
    </script>

</body>

</html>